<html><head>

    <link rel="stylesheet" href="../lib/vamonos.css">
    <link rel="stylesheet" href="demos.css">
    <script type="text/javascript" src="../lib/vamonos-all.js"></script>

    <style type="text/css">
        td.row-i.col-k {
            background-color: #ada;
        }
        td.row-i.col-j, td.row-jplus1.col-k {
            background-color: #ccc;
        }
    </style>

</head><body>

    <h1>Matrix-chain Multiplication</h1>

    <div class="vamonos">
        <div class="container" id="pseudocode" title="MatrixChainMult(dim):">
            for i = 1 to dim.length - 1
                opt[i,i] = 0
                sol[i,i] = "M i"
            for l = 2 to dim.length
                for i = 1 to dim.length - l
                    k = i + l - 1
                    opt[i,k] = &infin;
                    for j = i to k-1
                        if opt[i,k] &gt; dim[i-1]*dim[j]*dim[k] + best[i,j] + best[j+1,k]
                            opt[i,k] = dim[i-1]*dim[j]*dim[k] + best[i,j] + best[j+1,k]
                            sol[i,k] = "(sol[i][j] sol[j+1][k])"
        </div>
        <br>
        <div id="controls"></div>
        <br>
        <div class="container" id="array"></div>
        <br>
        <div class="container" id="opt"></div>
        <br>
        <div class="container" id="sol"></div>
    </div>
</body>

<script type="text/javascript">
var myviz = new Vamonos.Visualizer({
    widgets: [
        new Vamonos.Widget.Array({
            container: "array",
            showLabel: true,
            varName: "dim",
            defaultInput: [4, 3, 5, 1, 2, 7],
            showIndices: ["i-1", "j", "k"],
        }),

        new Vamonos.Widget.Matrix({
            container: "opt",
            varName: "opt",
            cssRules: [
                ["row", ">", "col", "shaded"],
                ["row", "=", "i", "row-i"],
                ["col", "=", "j", "col-j"],
                ["row", "=", "j+1", "row-jplus1"],
                ["col", "=", "k", "col-k"],
            ],
            showIndices: [
                ["row", "i"],
                ["row", "j+1"],
                ["col", "j"],
                ["col", "k"]
            ]
        }),

        new Vamonos.Widget.Matrix({
            container: "sol",
            varName: "sol",
            cssRules: [
                ["row", ">", "col", "shaded"],
                ["row", "=", "i", "row-i"],
                ["col", "=", "j", "col-j"],
                ["row", "=", "j+1", "row-jplus1"],
                ["col", "=", "k", "col-k"],
            ],
            showIndices: [
                ["row", "i"],
                ["row", "j+1"],
                ["col", "j"],
                ["col", "k"]
            ]
        }),


        new Vamonos.Widget.Pseudocode({
            container: "pseudocode",
            breakpoints: [7,9],
        }),

        new Vamonos.Widget.Controls("controls")
    ],

    algorithm: function (_) {
        with (this) {
            var l;
            opt = {};
            sol = {};
            for (var _i = 1; _i < dim.length; _i++) {
_(1);               i = _i;
_(2);               opt[i] = {}; opt[i][i] = 0;
_(3);               sol[i] = {}; sol[i][i] = "M" + i;
            }
            i = null;
            for (l = 2; l < dim.length; _(4), l++) {
_(4);           for (var _i = 1; _i < dim.length - l + 1; _i++) {
_(5);               i = _i;
_(6);               k = i + l - 1;
_(7);               opt[i][k] = Infinity;
                    for (var _j = i; _j < k; _j++) {
_(8);                   j = _j;
_(9);                   if (opt[i][k] > dim[i-1]*dim[j]*dim[k] + opt[i][j] + opt[j+1][k]) {
_(10);                      opt[i][k] = dim[i-1]*dim[j]*dim[k] + opt[i][j] + opt[j+1][k];
_(11);                      sol[i][k] = "(" + sol[i][j] + " " + sol[j+1][k] + ")";
                        }
                    }
                    j = null;
                }
                i = null;
            }
        }
    },

});

</script>
</html>
