<html><head>

    <link rel="stylesheet" href="../lib/vamonos.css">
    <link rel="stylesheet" href="demos.css">
    <script type="text/javascript" src="../deps/jquery.min.js"></script>
    <script type="text/javascript" src="../deps/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../deps/jquery-jsplumb.js"></script>
    <script type="text/javascript" src="../lib/vamonos.js"></script>

    <style type="text/css">
        .black { background-color: black; }
        .gray  { background-color: gray; }
        .left  { text-align: left }
    </style>

</head><body>

    <h1>Breadth-First Search</h1>


    <div class="vamonos left">
        <table><tr><td>
        <div class="container" id="pseudocode" title="BFS(G,s):">
            for each vertex u &in; G.V - {s}
                u.color = white
            s.color = gray
            Q = &empty;
            Q.enqueue(s)
            while Q &ne; &empty;
                u = Q.dequeue()
                for each v &in; G.Adj[u]
                    if v.color == white
                        v.color = gray
                        Q.enqueue(v)
                u.color = black
        </div>
        <br>
        <div id="controls"></div>
        </td><td valign='top' align='left'>
            <div class="container" id="display"></div>
        </td></tr></table>
                    
        <div class="container" id="graph"></div>
    </div>

    <script type="text/javascript">

        var myviz = new Vamonos.Visualizer({
            widgets: [

                new Vamonos.Widget.Console(),

                new Vamonos.Widget.Graph({
                    varName: "G",
                    container: "graph",
                    showVertices: ["u", "v"],
                    renderVertexContents: function(v, $vtx) {
                        if (v.color == "gray") {
                            $vtx.addClass('gray');
                        }
                        if (v.color == "black") {
                            $vtx.addClass('black');
                        }
                        $vtx.append("<div class='vertex-nw-label'>" + v.id + "</div>");
                    },
                    renderEdgeStyle: function (edge) {
                        return {lineWidth: 2};
                    },
                    defaultGraph: new Vamonos.DataStructure.Graph({
                        vertices : [
                            {id: 'v0', x: 100, y: 081},
                            {id: 'v1', x: 329, y: 012},
                            {id: 'v2', x: 272, y: 104},
                            {id: 'v3', x: 393, y: 272},
                            {id: 'v4', x: 052, y: 217},
                            {id: 'v5', x: 131, y: 325},
                            {id: 'v6', x: 267, y: 369},
                            {id: 'v7', x: 497, y: 353},
                            {id: 'v8', x: 514, y: 155},
                            {id: 'v9', x: 253, y: 200}
                        ],
                        edges : [
                            {source: 'v0', target: 'v1'},
                            {source: 'v0', target: 'v2'},
                            {source: 'v1', target: 'v3'},
                            {source: 'v1', target: 'v8'},
                            {source: 'v2', target: 'v4'},
                            {source: 'v2', target: 'v3'},
                            {source: 'v4', target: 'v0'},
                            {source: 'v1', target: 'v2'},
                            {source: 'v3', target: 'v4'},
                            {source: 'v4', target: 'v5'},
                            {source: 'v5', target: 'v6'},
                            {source: 'v6', target: 'v7'},
                            {source: 'v8', target: 'v7'},
                            {source: 'v2', target: 'v9'}
                        ]
                    })
                }),

                new Vamonos.Widget.VarDisplay({
                    container: "display",
                    watch: ["u[id,color]", "v[id,color]", "Q"]
                }),

                new Vamonos.Widget.Pseudocode({
                    container: "pseudocode",
                    setAllBreakpoints: true
                }),

                new Vamonos.Widget.Controls({
                    container: "controls",
                    showWhileSliding: true
                }),

            ],

            algorithm: function (viz) {
                with (viz.stash) {
                    var _ = function(n){ viz.line(n); }; 
                    s = G.vertices[1];

                    for (var i = G.vertices.length - 1; i >= 0; i--) {
                        if (u === s) { continue }
                        _(1); u = G.vertices[i];
                        _(2); u.color = "white";
                    }

                    _(3); s.color = "gray";

                    _(4); viz.stash.Q = new Vamonos.DataStructure.Queue();

                    _(5); Q.enqueue(s);

                    while (_(6), !Q.isEmpty()) {

                        _(7); u = Q.dequeue();

                        var adj = G.neighbors(u);
                        for (var j = 0; j < adj.length; j++) {
                            _(8); v = adj[j];

                            if (_(9), v.color === "white") {
                                _(10); v.color = "gray";
                                _(11); Q.enqueue(v);
                            }

                        }
                        _(12); u.color = "black";
                    }
                }
            }
        });

    </script>

</body>
</html>
