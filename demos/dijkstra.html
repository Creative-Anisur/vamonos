<html><head>

    <link rel="stylesheet" href="../lib/vamonos.css">
    <link rel="stylesheet" href="demos.css">
    <script type="text/javascript" src="../deps/jquery.min.js"></script>
    <script type="text/javascript" src="../deps/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../deps/jquery-jsplumb.js"></script>
    <script type="text/javascript" src="../lib/vamonos.js"></script>

    <style type="text/css">
        .vertex-contents {
            font-family: sans-serif;
            font-size: .8em;
        }

        .vertex-sw-label {
            font-family: sans-serif;
            font-size: .6em; 
        }

        .vertex-ne-label {
            font-style: italic;
            color: #FF7D7D;
        }

        .vertex-nw-label {
            font-style: italic;
            color: #274D1A;
        }

        .done {
            background: #1F3A66; 
        }

        .done .vertex-contents { 
            color: white; 
        }

        td { 
            vertical-align: top;
            text-align: left;
        }
    </style>

</head><body>

    <h1>Dijkstra's Algorithm</h1>

    <table><tr><td>
        <div id="pseudocode-main" title="Dijkstra(G,s):" class="container">
            for each vertex u &in; G.V - {s}
                u.d = &#x221E;
                u.pred = null
                u.done = false
            s.d = 0
            Q = G.V
            while Q &ne; &empty;
                u = Q.extractMin()
                u.done = true
                for each v &in; G.Adj[u]
                    Relax(u,v)
        </div><br>
        <div id="pseudocode-relax" title="Relax(G,u,v):" class="container">
            if u.d + G.edge(u,v).w < v.d
                v.d = u.d + G.edge(u,v).w
                v.pred = u
        </div><br>
        <div id="controls"></div><br>
    </td><td>
        <div id="graph" class="container"></div><br>
        <div id="vars" class="container"></div><br>
        <div id="queue"></div><br>
    </td></tr></table>

</body>
<script type="text/javascript">
var myviz = new Vamonos.Visualizer({
    widgets: [
        new Vamonos.Widget.Console(),

        new Vamonos.Widget.Controls({
            container: "controls",
            showWhileSliding: true,
        }),

        new Vamonos.Widget.Queue({
            container: "queue",
            varName: "main::Q",
            showLabel: true,
            displayOnly: true,
        }),

        new Vamonos.Widget.Pseudocode({
            container: "pseudocode-main",
            //breakpoints: "all"
        }),

        new Vamonos.Widget.Pseudocode({
            container: "pseudocode-relax",
            //breakpoints: "all",
            procedureName: "relax",
            setAllBreakpoints: true,
        }),

        new Vamonos.Widget.VarDisplay({
            container: "vars",
            watch: ["u", "v"],
        }),

        new Vamonos.Widget.Graph({
            varName: "G",
            container: "graph",
            inputVars: {
                s: "v0",
            },
            vertexLabels: {
                inner : [function(vtx){return vtx.name}, function(vtx){return vtx.d}],
                sw    : [function(vtx){return ""}, function(vtx){return vtx.name}],
                ne    : ["u", "v"],
                nw    : ["s"],
            },
            vertexCssAttributes: {
                done: true,
            },
            edgeLabel: [ "w", 1 ],
            colorEdges: [
                ["u->v", "#FF7D7D"],
                [ function(edge){
                    return (edge.target.pred ? edge.target.pred.id === edge.source.id : false)
                        || (edge.source.pred ? edge.source.pred.id === edge.target.id : false) }
                , "#92E894" ],
            ],
            defaultGraph: new Vamonos.DataStructure.Graph({
                //directed: true,
                vertices: [ 
                    {id: "v0", x: 17,  y: 10},
                    {id: "v1", x: 98,  y: 10},
                    {id: "v2", x: 176, y: 13},
                    {id: "v3", x: 15,  y: 78},
                    {id: "v4", x: 100, y: 80},
                    {id: "v5", x: 182, y: 80},
                    {id: "v6", x: 15,  y: 138},
                    {id: "v7", x: 100, y: 140},
                    {id: "v8", x: 182, y: 140},
                ],
                edges: [
                    {source: 'v0',target: 'v4', w:1},
                    {source: 'v1',target: 'v2', w:2},
                    {source: 'v1',target: 'v4', w:5},
                    {source: 'v3',target: 'v4', w:3},
                    {source: 'v3',target: 'v6', w:1},
                    {source: 'v4',target: 'v8', w:4},
                    {source: 'v5',target: 'v8', w:2},
                    {source: 'v6',target: 'v7', w:3},
                    {source: 'v7',target: 'v8', w:2},
                ]
            }),
        }),
    ],

    algorithm: {

        main: function(){
            G.eachVertex(function(vtx){
_(1);           u = vtx;
_(2);           u.d = Infinity;
_(3);           u.pred = undefined;
_(4);           u.done = false;
            });

_(5);       s.d = 0;
_(6);       Q = new Vamonos.DataStructure.Queue({
                initialArray: G.vertices,
                comparator: function(a,b){ return a.d - b.d },
            });

            while (_(7), !Q.isEmpty()) {
_(8);           u = Q.extractMin();
_(9);           u.done = true;
                G.eachNeighbor(u, function(vtx){
_(10);              v = vtx;
_(11);              relax({u:u,v:v,G:G});
                });
                v = undefined;
            }
            u = undefined;
        },

        relax: function(){
            if (_(1), u.d + G.edge(u,v).w < v.d) {
_(2);           v.d = u.d + G.edge(u,v).w;
_(3);           v.pred = u;
            }
        }
    }
});

</script></html> 
